\section{Introduction}

Biometrics is the use of the human body's inherent physiological and behavioral characteristics for person identification. For the physiological characteristics, there are many human characteristics such as retina, iris, face, fingerprints and palm prints; as far as the behavioral characteristics, the available features include gait recognition, voice and other behavioral characteristics. As for the finger knuckle, it has also attracted many researchers devoted to it, because it is easier to expose, easier to collect, and it has also been proven to be unique and stable \cite{kumar2014importance}. Many early works on biometric recognition of finger knuckle, ranging from coding-based methods, subspace methods and texture analysis methods to 3D shape patterns based on 3D image reconstruction, and different methods have been used to achieve highly accurate recognition results. 

Contactless finger knuckle identification should be studied extensively because it is more security and more hygienic, especially now with COVID-19. At the same time, It has attracted the attention of many researchers and achieved many result. Even early work considered application scenario using cell phones for finger knuckle recognition \cite{cheng2012contactless}, but for finger knuckle segmentation using fixed finger position in the centre of the image is not very convenient for the user, for recognition phase log-Gabor is used for feature extraction, and Hamming distance is used for matching. Meanwhile these paper \cite{kumar2019toward}, \cite{cheng2020deep}, \cite{kapoor2020completely} are the latest in research on the topic.

\subsection{Related Work}
\textbf{Finger Knuckle Recognition}

For the traditional recognition algorithms, there are generally two main types: one is holistic-based, and the other is local feature-based. The broad category can be divided into subspace and spectral representation methods for holistic-based \cite{yang2011finger}, \cite{neware2013finger}, \cite{meraoumia2011fusion}. Sub-space methods are generally used for data dimensionality reduction and noise reduction \cite{zhang2006biometric}, such as the use of principal component analysis to reduce the dimensionality of multidimensional data. In contrast to spectral representation methods, image space transformation can be performed as well as image feature enhancement and correlation coefficients for feature extraction \cite{hennings2005verification}. For the processing of local information, there are many algorithms, including, for example, extracting information about the gradient of the image edges, obtaining the boundary points, using other edge extraction algorithms such as Hough change. For example, a 1D log-Gabor filter was used to extract the finger knuckles' features and for the matching phase, the hamming distance was used here for the matching score calculation since it is a local feature-based method \cite{meraoumiapersonal}. Alternatively, a 2D Gabor filter is used to extract the domain orientation information features of the finger knuckles, and an angular distance calculation is used to calculate the similarity between the different features for the matching score \cite{mehrotra1992gabor}. High recognition accuracy has been achieved for these matching algorithms, even up to $98.67\%$ \cite{yang2011finger}.

However, these traditional algorithms have a common problem that these algorithms have to keep changing their corresponding filters and even the corresponding detection parameters under different scenario \cite{zheng20163d}. In other words, traditional algorithm cannot learn filters and parameters by themself. With the development of neural network, the generalization ablity of feature extraction and feature matching method becomes more robust. Especially, from the oldest LeNet \cite{lecun1998gradient} to nowadays EfficientNetV2 \cite{tan2021efficientnetv2} model, the CNN models have achieved great success in computer vision tasks. Therefore, the CNN models also can be used on finger knuckle identification tasks. Such as FKNet \cite{cheng2020deep} based on the ResNet-50 \cite{he2016deep}, it use the FKNet to classify the subject from the 3D feature of finger knuckle. There are even manay that combine traditional methods with CNN models. Forr example \cite{kapoor2020completely}, it first extracts different information with Gabor filters, and then uses CNN to learn the most important information.



\textbf{Object Detection and Segmentation}

For the efficiency of the matching algorithm, the accuracy of the region of interest of object is a factor that can determine the matching efficiency and accuray. The size of the region of interest should be comparable to the size of the actual target object at the pixel level so that the size obtained after segmentation will not have redundant pixel information, which will reduce the pixel values to be computed for both the extraction and the subsequent matching sessions. 

As for the traditional method, their \cite{kumar2019toward}, \cite{cheng2012contactless} approach is to fix the finger knuckle position in the image when taking the finger knuckle data without complexity background, and then extract the edges of the object. Most importantly, the traditional segmentation algorithm cannot correctly segment the finger knuckles in the presence of complex background interference, multiple finger knuckles in the same field of view, obscured finger knuckles or bent finger knuckles. It is difficult to use traditional object segmentation methods to automatically segment finger knuckles for applications such as in the wild. Models of neural network models for object detection have achieved great success, whether it is the sliding window detection algorithm, the 2-stage series of R-CNN models \cite{girshick2014rich}, \cite{girshick2015fast}, \cite{ren2015faster}, or the 1-stage YOLO series \cite{redmon2016you}, \cite{redmon2017yolo9000}, \cite{redmon2018yolov3}, \cite{bochkovskiy2020yolov4} and SSD models \cite{liu2016ssd} up to the current position, and even the anchor-free based object detection algorithm \cite{xin2021pafnet} as well. Each of these models has its advantages. For the 2-stage model, the object detection accuracy is guaranteed, the 1-stage based model is a speedup based on the positive accuracy, and the anchor-free is a further improvement in the detection speed. In this paper, the latest version of the YOLO model series, YOLOv5 \cite{YOLOv5}, is used as the network model for finger knuckle detection because the YOLO series is famous for its fast detection speed and high accuracy.


\subsection{Our Works}

As for the contactless finger knuckle identification, the most difficult problem is how to deal with the deformable crease texture of finger knuckle while with different angle. Although many methods have obtained good recognition accuracy, the finger knuckles are easily deformed under practical application scenarios, and the finger knuckle features will change accordingly. Thus, the matching accuracy will be degraded. Because of the above problems, there are corresponding studies to solve the finger knuckle deformation problem and provide new data sets and new methods \cite{kumar2019toward}. The paper \cite{kumar2019toward} first matches on two images for a selected fixed number $32*32$ of point pairs for coping with the deformation problem and then uses local feature descriptors on each point pair for matching. And at the RFNet \cite{liu2020contactless}, it shift the feature maps for getting the minimal matching score to solving the palmprint shift problem. Meanwhile on the person re-identification problem, the paper \cite{ahmed2015improved} uses the cross-input neightborhood differences module to calculate difference of one feature maps with another with more range to add robustness to positional differences, and the paper \cite{subramaniam2016deep} use the normalieze correlation layer to achieve the similar problem. However, both of them just shift or calculate with more range but still on the horizontal and vertical direction, no one think about the rotaion. Therefore, based on the Soft-Shifted Triplet Loss \cite{liu2020contactless}, we can also rotate to deal with more complex deformations.

Another problem is tow to aotumatically segment the finger knuckle region on the real time on the contactless and online finger knuckle identification. From the above contactless fingr knuckle paper, they just use the traditional method to fix the finger knuckle position on a image or vedio. But just like I said before, the traditional method cannot solve the comlexity phenomenon. And I have found that on the fing knuckle identification, it seems that no one use deep learing to detection and segmentation. A new finger knuckle object detection algorithm is used, which can automatically extract the region of interest of finger knuckle based on the YOLOv5 \cite{YOLOv5} model framework and integrates the angle prediction function. It is beneficial to the matching speed and accuracy of the matching algorithm and the automatic target segmentation using the object detection model to extract the ROI region of the major finger knuckle. The angle information of the finger knuckle can be obtained. If the algorithm of ROI segmentation is accurate enough and the accuracy of the rotation is also high enough, this will naturally improve the detection efficiency.

In conclusion, if we want to perform contactless finger knuckle recognition in a real-world scenario or a online scenario, the most critical problem comes from two aspects:how to match with high accuracy in real-world applications, and the second one is how to efficiently perform finger knuckle segmentation and correction. Therefore, our contribution can be summarized as below:
\begin{itemize}
    \item We desigin a new loss function for solving finger knuckle deformation with rotaion and translation, called TRTL loss funtion. After comparision, our TRTL can increase mathing perform when compare to STTL. Even, our TRTL not only can be used on the finger knuckle identification, but also can be used on other biometric identification.
    \item We use the YOLOv5-CSL to automatically detection and segmentation. Based on the YOLOv5, we add the angle prediction on the horizontal bounding box for getting more better quality segmented ROI, and we can use the angle information to normalize picture. From the segmented finger knuckle by YOLOv5-CSL, the matching perform can be increased when use these finger knuckle database offered.
    \item We design a online finger knuckle identification software for completely contactless and online finger knuckle identification.
\end{itemize}

Section 3 will explain our designed TRTL loss function and prove that it can be differentiable by equation. Section 4 contains all experiments and corresponding results, including within database experiments and cross database experiments, and 2D finger knuckle and 3D finger knuckle. And also contain the ablation study with changing translation size and rotaion size.
Section 5 introduces the finger knuckle detection model and how to implement the detection of finger knuckle angle information. Section 6 is to prove the online finger knuckle identification performance.